@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    @model HashSet<Insurance_agency.Models.ModelView.Policy>
    Layout = "~/Areas/AdminArea/Views/Shared/_AdminLayout.cshtml";
}

<style>
    .policy-item {
        background-color: white;
        color: black;
        transition: background-color 0.3s ease;
    }

        .policy-item:hover {
            background-color: #eef6ff;
        }

            .policy-item:hover .policy-actions {
                display: flex !important;
            }

    .policy-actions {
        gap: 5px;
    }
</style>

<h2 class="text-primary"><strong> Chi tiết các chính sách của gói bảo hiểm :</strong>Bảo hiểm An Khang</h2>
<h5 class="text-primary">Mã bảo hiểm: #BHNT02483</h5>

<br/>
<br />
<h3 class="text-primary align-content-center">Bản xem trước nội dung chính sách:</h3>
<br/>
@* 
<table class="table table-hover">
    <thead>
        <tr>
            <th scope="col">STT</th>
            <th scope="col">Mô tả chính sách</th>
            <th scope="col">Last</th>
            <th scope="col">Active</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th scope="row">1</th>
            <td>Mark</td>
            <td>Otto</td>
            <td>mdo</td>
        </tr>
        <tr>
            <th scope="row">2</th>
            <td>Jacob</td>
            <td>Thornton</td>
            <td>fat</td>
        </tr>
        <tr>
            <th scope="row">3</th>
            <td colspan="2">Larry the Bird</td>
            <td>twitter</td>
        </tr>
    </tbody>
</table> *@
<div class="container" style="margin:20px;background-color:white;height:500px;width:1000px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);overflow-y:scroll" id="policy_content">
    @if (Model != null && Model.Count > 0)
    {
        HashSet<Insurance_agency.Models.ModelView.Policy> policies = Model;
        foreach (var policy in policies)
        {
            <div class="policy-item d-flex justify-content-between align-items-start p-3 mb-2">
                <div class="policy-content flex-grow-1">
                    @Html.Raw(policy.description)
                </div>
                <div class="policy-actions d-none align-items-start">
                    <button class="btn btn-sm btn-warning me-1" title="Chỉnh sửa">
                       Sửa
                    </button>
                    <button class="btn btn-sm btn-danger" title="Xoá">
                       Xoá
                    </button>
                </div>
            </div>

        }
    }
</div>
<br/>
<br/>
<br />
<br />
<h4 class="text-primary">Trình soạn thảo chính sách</h4>

<form method="post" action="/adminarea/dashboard">
    <textarea id="default-editor" style="width:1000px" onchange="handleChange(event)">
    <p><em>Hello</em>, <span style="text-decoration: underline;"><strong>World!</strong></span></p>
</textarea>

   
</form>
<button type="button" class="btn btn-primary" onclick="submitContent()">Submit</button>



        <script>
    function submitContent() {
        const content = tinymce.get('default-editor').getContent();

        console.log("Nội dung"+content);

        $.ajax({
            type: "POST",
            url: "/adminarea/policymanagement/create",
            data: { insurance_id: @(ViewBag.insuranceId),description: content, active:1 },
            success: function (response) {
                console.log("Nội dung đã được gửi thành công");
                // Xử lý phản hồi từ máy chủ nếu cần
                $("#policy_content").append(`
                    <div class="policy-item d-flex justify-content-between align-items-start p-3 mb-2">
                        <div class="policy-content flex-grow-1">
                           ${content}
                        </div>
                        <div class="policy-actions d-none align-items-start">
                            <button class="btn btn-sm btn-warning me-1" title="Chỉnh sửa">
                                <i class="bi bi-pencil-fill"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" title="Xoá">
                                <i class="bi bi-trash-fill"></i>
                            </button>
                        </div>
                    </div>
                `);

                $("#default-editor").empty();
            },
            error: function (error) {
                console.error("Lỗi khi gửi nội dung:", error);
            }
        });
    }
        </script>